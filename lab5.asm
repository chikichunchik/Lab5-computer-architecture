 TITLE laba5
;------------------------------------------------------------------------------
;??  ?5, ??????? ?3, ??-01
;------------------------------------------------------------------------------
;----------------I.????????? ????????------------------------
IDEAL
MODEL SMALL
STACK 16384
;-----------------------II.???????--------------------------------------
; ???????? ?????? ??? ?????????????
MACRO M_Init        ; ??????? ??????? 
    mov ax,@data    ; @data ?????????????, ?? ??????????? ?????????? model
    mov ds, ax  ; ???????????? ??????? ???????? ????? ? ??????? ds
    mov es, ax  ; ???????????? ??????? ???????? ????? ? ??????? es
    ENDM M_Init     

;--------------------III.??????? ???????? ?????--------------
DATASEG

;?????????? ???????????? ?????????????????? ?????? 16?16
array2Db        DW  '3', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '3', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '3', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '3', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '2', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '2', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '2', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '2', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '2', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '2', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '2', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                Dw  '2', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '2', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '3', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '3', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6'
                DW  '3', '4', '8', '9', '7', '3', '0', '3', '9', '0', '7', '6', '1', '0', '8', '6',13, 10,'$'

exCode  DB 0
Vladbrth dw '1','4','0','2','2','0','0','3'
Andrybrth dw '1','8','1','1','2','0','0','2'
Irabrth  dw '0','5','0','7','2','0','0','3'
Codeseg
;----------------------VI. ??????? ???????? ????-------------------
Start: 
M_Init
call sort  ; ???????? ?????
xor si,si
lea ax,[array2Db]   ; ????????? ??????? ??????, ??? ???????? ???????
mov dx,ax
mov ah, 09h
int 21h             ; ???????? ?????
mov ah,01h
int 21h             ; ????? ?? ???????? ???????
lea si,[array2Db]
add si,66h             ; ????????????? ? ?????????? (3,3)
mov cx,2            
add_to_array:           ; ????, ?? ???????? ??????????? 8 ?? 6
    lea di,[Vladbrth]   ; ????????? ? ??????? ??????? ??? ??????????
    push cx             ; ????????????? ?????????? ????????
    call add_brth        ; ????????? ????? ????
    add si,10h              ; ????????????? ? ????????? ?????
    call add_brth           ; ????????? 2 ????
    add si,10h
    call add_brth           ; ????????? 3 ????
    pop cx                  ; ?????????? ? ??????? ????????? ????????, ?? ??????????
    add si,10h
loop add_to_array


lea di,[Vladbrth]       ; ??????? ?? 2 ????? ?? ??????????? ???????????? 8 ?? 6
call add_brth
add si,10h
call add_brth

mov ah, 09h             ; ???????? ????? ????? ? ??????
int 21h
mov ah,01h
int 21h

mov ah,4ch              ;????? ? ????????
mov al,[exCode]
int 21h 
;---------------------?????????-----------------------------------------
proc sort
mov bp,256  ; ??????? ????????? ???????? ??????????? ?????
C:
    mov cx, 256 ; ??????? ????????? ???????? ???????????? ?????
    dec cx      ; ?????????? ?????? ??????? ?????????? ????????, ????????????? ????????? ????????
    lea bx, [array2Db] ; ????????? ? ??????? ??????? ??????
    mov si, 510             ; ????????????? ? ??????
B:
    mov ax, [bx + si]  ; ????????? ???????? ???????
    mov di, si
    A:  
        sub di, 2           
        mov dx, [bx + di]       ; ?????????? ?? ?????????? (??????? ? ?????)
 
        cmp ax, dx              ; ????????? ??? 2 ????????
        jng next                 ; ???? ?????? ?????? ?? ??????,??????????? ??? ???????? ?????
            mov [bx+di], ax     ; ??????????? ?? 2 ????????
            mov [bx+si], dx
     next:
     sub si, 2                  ; ?????????? ?? ?????????? ????????
     loop B
        xor si, si             ; ?????????? ????? ?? 1 ????????
         xor di, di
         dec bp                ; ?????????, ?? ???????? ?????????
         cmp bp,0               ; ?????????? ???????? ???????? ? 0
         jne c                  ; ?????????? ????, ???? ?? ???????? ??? ????????
 
 
ret
endp sort
   
proc add_brth
mov cx,8                ; ??????? ????????? ????????
do_it:
mov ax,[ds:di]              ; ????????????? ?????
mov [ds:si],ax              ; ????????? ???? ? ?????
add si,2                    ; ?????????? ?? ?????????
add di,2
loop do_it
ret
endp add_brth
 
end Start